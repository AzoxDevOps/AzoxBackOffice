@page "/admin/merchant"

<SummaryLayout PageTitle="İşletmeler">
    <PageToolbar>
        <div class="btn-group btn-group-sm btn-group-hover">
            <a class="btn btn-sm btn-primary rounded-4 me-2" href="/admin/merchant/new">
                <i class="bi bi-plus"></i>
                <span>Yeni</span>
            </a>
        </div>
    </PageToolbar>
    <Search>
        <EditForm Model="FilterArgs" OnValidSubmit="SummaryFilter">
            <div class="container-fluid">
                <div class="row mb-2">
                    <div class="col-12 col-md-6">
                        <label class="col-form-label col-form-label-sm">İşletme Adı</label>
                        <input class="form-control form-control-sm" @bind-value="FilterArgs.Name" />
                    </div>
                    <div class="col-12 col-md-6">
                        <label class="col-form-label col-form-label-sm">İşletme Tipi</label>
                        <select class="form-select form-select-sm" @bind="FilterArgs.MerchantTypeId">
                            @foreach (var item in FilterArgs.MerchantTypes)
                            {
                                <option value="@item.Value" selected="@item.Selected">@item.Text</option>
                            }
                        </select>
                    </div>
                </div>
                <div class="row">
                    <div class="col">
                        <div class="d-flex justify-content-center align-items-center">
                            <button class="btn btn-primary" type="submit" disabled="@FilterArgs.IsBusy">
                                @if (FilterArgs.IsBusy)
                                {
                                    <div class="spinner-border spinner-border-sm"><span class="visually-hidden"></span></div>
                                }
                                else
                                {
                                    <i class="bi bi-search">&nbsp;</i>
                                    <span>Arama</span>
                                }
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </EditForm>
    </Search>
    <PageBody>
        <RadzenDataGrid TItem="MerchantDto" Data="Model" AllowSorting="true" AllowPaging="true" PageSize="10" PageSizeOptions="new List<int>{5,10,20,50,100}">
            <Columns>
                <RadzenDataGridColumn TItem="MerchantDto" Property="Name" Title="İşletme Adı" />
                <RadzenDataGridColumn TItem="MerchantDto" Title="İşletme Tipi">
                    <Template Context="merchant">
                        <span>@merchant.MerchantType.GetDescription()</span>
                    </Template>
                </RadzenDataGridColumn>
                <RadzenDataGridColumn TItem="MerchantDto" Property="Contact.Name" Title="Yetkili" />
                <RadzenDataGridColumn TItem="MerchantDto" Title="Durum">
                    <Template Context="merchant">
                        <span>@(merchant.IsActive ? "Aktif" : "Pasif")</span>
                    </Template>
                </RadzenDataGridColumn>
                <RadzenDataGridColumn TItem="MerchantDto">
                    <Template Context="merchant">
                        <div class="d-flex justify-content-end">
                            <div class="btn-group btn-group-sm">
                                <button class="btn btn-sm btn-primary rounded-4 me-2"
                                        @onclick="@(() => NavigationManager.NavigateTo($"/admin/merchant/{merchant.Id}"))">
                                    <i class="bi bi-pen"></i>
                                </button>
                                <button class="btn btn-sm btn-danger rounded-4">
                                    <i class="bi bi-trash"></i>
                                </button>
                            </div>
                        </div>
                    </Template>
                </RadzenDataGridColumn>
            </Columns>
        </RadzenDataGrid>
    </PageBody>
</SummaryLayout>